首网页包括两个网页入口：一是自动计算快递费用，网址为https://costcalculate.netlify.app/，已经搭建好。另一个是shipping route cost & LT automatic sorting，需要搭建。

搭建的要求如下：
Shipping MAP可视化，根据草图创建实际连接。此MAP可进行修改/更新，具体修改/更新依据在后文给出。


用户根据节点两端的地点（location）和路线名称（节点）进行整体路线选择。分为节点选择和location选择，以选择框加指向箭头的方式显示在网页当中，节点显示在两个location中间的连接线上。如果先选择location，则会自动显示节点；如果先选择节点，location很可能要再进行选择，因为一个节点里面可能对应多个location。

选择完节点和location以后，根据选择，把节点下面涉及到的需要输入/选择的基本信息列表显示出来供用户输入/选择。

把输入/选择以后的节点各个节点费用进行列表显示，分为基础费用和可变费用。整体路线为各个节点的加和，需要加和的内容包括费用和Lead Time。展示的时候也要显示节点＋节点+..+节点=费用和Lead Time的布局（分两行）。

识别表格“5.shipping cost based on summary”中的每一个工作表的MAP列。标题通常在第二行，建议搜寻前5行查找标题。MAP列的内容为节点。MAP标题栏所在同一行的From和To标题为对应的location。此为第2点中的数据选择来源。节点/location选择框可以添加或者删除，根据整体线路涉及的节点数，用户可自行调整。

判断每一个节点属于工作表“WAHL-Customer”、“VENDOR-WAHL”、“WAHL-DGWA”中的哪一个。如果属于WAHL-Customer工作表，根据第2点用户的选择，把To标题后一列到SUMMARY标题之间有数据的列显示出来，需要显示标题和具体的内容，显示的位置为节点对应的下方。如果识别到内容为空或者为N/A则不显示该列。内容以下拉菜单选择或者输入的方式供用户提供数据，其中SUMMARY标题下方的内容需要先进行转换再显示给用户进行选择/输入，标题SUMMARY转换为Shipping method，如果内容为A、B、C，分别转换为Ocean、Air、Land。等用户选择/输入完毕以后，选择的在工作表中存在对应行，查看选择行对应的E2E Cost列对应的结果，每一个节点对应的结果相加即为最终的费用，每一个节点对应的E2E Lead Time列的结果即为最终的Lead Time；输入的在工作表中没有对应行时，判断输入的是否为除了CBM和G/W列内容对应不上，其它列内容都能对应上，如果是，则根据用户输入的值进行E2E Cost计算。计算方式参考E2E Cost列里面的计算公式，把CBM和G/W列原有值替换成用户输入的值进行E2E Cost计算即可得出结果（注意对应行和公式计算所用行相差一行）。注意用户输入的信息在WAHL-Customer工作表中对应的行为合并行，在WAHL-Customer工作表中E2E Lead Time列的值在合并行的第二行，判断合并行的第一行内容，如果内容中包含MIN，则需要判断MIN后面的数值和计算值之间的比较，计算值为MIN前面的数值乘以PALLET QTY列的值，如果计算值大于MIN后面的值，则取计算值，如果小于，则取MIN后面的值。

如果属于VENDOR-WAHL工作表，根据第2点用户的选择，把To标题后一列到SUMMARY标题之间有数据的列显示出来，需要显示标题和具体的内容，显示的位置为节点对应的下方。如果识别到内容为空或者为N/A则不显示该列。内容以下拉菜单选择或者输入的方式供用户提供数据，其中SUMMARY标题下方的内容需要先进行转换再显示给用户进行选择/输入，标题SUMMARY转换为Shipping method，如果内容为A、B、C，分别转换为Ocean、Air、Land。等用户选择/输入完毕以后，选择的在工作表中存在对应行，查看选择行对应的E2E Cost列对应的结果，每一个节点对应的结果相加即为最终的费用，每一个节点对应的E2E Lead Time列的结果即为最终的Lead Time；输入的在工作表中没有对应行时，判断输入的是否为除了CBM和G/W列内容对应不上，其它列内容都能对应上，如果是，则根据用户输入的值进行E2E Cost计算。计算方式参考E2E Cost列里面的计算公式，把CBM和G/W列原有值替换成用户输入的值进行E2E Cost计算即可得出结果（注意对应行和公式计算所用行相差一行）。注意用户输入的信息在VENDOR-WAHL工作表中对应的行为合并行，在VENDOR-WAHL工作表中E2E Lead Time列的值在合并行的第二行，判断合并行的第一行内容。如果内容中包含MIN和CBM，则需要判断MIN后面的数值和计算值之间的比较，计算值为MIN前面的数值乘以7.8乘以CBM列的值，如果计算值大于MIN后面的值，则取计算值，如果小于，则取MIN后面的值；如果内容中包含MIN和KG，则需要判断MIN后面的数值和计算值之间的比较，计算值为MIN前面的数值乘以G/W列的值，如果计算值大于MIN后面的值，则取计算值，如果小于，则取MIN后面的值。

如果属于WAHL-DGWA工作表，根据第2点用户的选择，把To标题后一列到SUMMARY标题之间有数据的列显示出来，需要显示标题和具体的内容，显示的位置为节点对应的下方。如果识别到内容为空或者为N/A则不显示该列。内容以下拉菜单选择或者输入的方式供用户提供数据，其中SUMMARY标题下方的内容需要先进行转换再显示给用户进行选择/输入，标题SUMMARY转换为Shipping method，如果内容为A、B、C，分别转换为Ocean、Air、Land。等用户选择/输入完毕以后，选择的在工作表中存在对应行，查看选择行对应的E2E Cost列对应的结果，每一个节点对应的结果相加即为最终的费用，每一个节点对应的E2E Lead Time列的结果即为最终的Lead Time。

第4点，主要涉及到WAHL-Customer和VENDOR-WAHL工作表。把输入/选择以后的节点各个节点费用进行列表显示，分为基础费用和可变费用。基础费用列表为工作表第一行识别到内容1、2、3...且无填充颜色的列，第二列对应的标题名称即为需要显示的基础费用列表。可变费用列表为工作表第一行识别到内容1、2、3...且填充颜色为绿色的列，第二列对应的标题名称即为需要显示的可变费用列表。

以上所有操作都要有日志记录，涉及到计算的，把计算数据和公式进行记录，方便纠错。

